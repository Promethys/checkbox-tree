function h({state:a,options:c,indeterminateItems:d,searchable:o=!1,collapsible:u=!1,defaultCollapsed:f=!1,parentKeys:p=[],storeParentKeys:y=!1}){return{state:a,options:c,indeterminateItems:d,areAllSelected:!1,searchable:o,search:"",collapsible:u,defaultCollapsed:f,collapsedItems:[],parentKeys:p,storeParentKeys:y,init(){this.$watch("state",()=>{this.updateIndeterminateStates(),this.updateAreAllSelected()}),this.updateAreAllSelected(),this.collapsible&&(this.collapsedItems=this.defaultCollapsed?[...this.parentKeys]:[])},filterState(e){return this.storeParentKeys?e:e.filter(t=>!this.parentKeys.includes(t))},isCollapsed(e){return this.collapsible?this.collapsedItems.includes(e):!1},toggleCollapsed(e){this.collapsible&&(this.collapsedItems.includes(e)?this.collapsedItems=this.collapsedItems.filter(t=>t!==e):this.collapsedItems=[...this.collapsedItems,e])},expandAll(){this.collapsedItems=[]},collapseAll(){this.collapsedItems=[...this.parentKeys]},isItemVisible(e,t){if(!this.searchable||!this.search||this.search.trim()==="")return!0;let i=this.search.toLowerCase();if((t||"").toLowerCase().includes(i))return!0;let n=this.findOptionByKey(e);return n&&n.children?this.hasMatchingDescendant(n.children,i):!1},hasMatchingDescendant(e,t){for(let[i,s]of Object.entries(e))if((typeof s=="string"?s:s.label||"").toLowerCase().includes(t)||s.children&&this.hasMatchingDescendant(s.children,t))return!0;return!1},findOptionByKey(e,t=null){t=t||this.options;for(let[i,s]of Object.entries(t)){if(i===e)return s;if(s.children){let n=this.findOptionByKey(e,s.children);if(n)return n}}return null},hasVisibleResults(){if(!this.searchable||!this.search||this.search.trim()==="")return!0;let e=this.search.toLowerCase();return this.hasAnyMatch(this.options,e)},hasAnyMatch(e,t){for(let[i,s]of Object.entries(e))if((typeof s=="string"?s:s.label||"").toLowerCase().includes(t)||s.children&&this.hasAnyMatch(s.children,t))return!0;return!1},selectAll(){this.state=this.filterState(this.getAllKeys(this.options)),this.updateIndeterminateStates(),this.updateAreAllSelected()},deselectAll(){this.state=[],this.updateIndeterminateStates(),this.updateAreAllSelected()},updateAreAllSelected(){let e=this.getAllKeys(this.options);this.areAllSelected=e.length>0&&e.every(t=>this.isChecked(t))},getAllKeys(e){let t=[];return Object.entries(e).forEach(([i,s])=>{t.push(i),s.children&&Object.keys(s.children).length>0&&t.push(...this.getAllKeys(s.children))}),t},isChecked(e){return Array.isArray(this.state)&&this.state.includes(e)},isParentChecked(e){let t=this.getChildrenKeys(e);return t.length===0?this.isChecked(e):t.every(i=>this.isChecked(i))},isIndeterminate(e){let t=this.getChildrenKeys(e);if(t.length===0)return!1;let i=t.filter(s=>this.isChecked(s));return i.length>0&&i.length<t.length},toggleParent(e){let t=this.getChildrenKeys(e),i=!this.isParentChecked(e);if(Array.isArray(this.state)||(this.state=[]),i){let s=this.filterState([e,...t]).filter(n=>!this.state.includes(n));this.state=[...this.state,...s]}else{let s=[e,...t];this.state=this.state.filter(n=>!s.includes(n))}this.updateIndeterminateStates()},toggleChild(e){Array.isArray(this.state)||(this.state=[]),this.isChecked(e)?this.state=this.state.filter(i=>i!==e):this.state=[...this.state,e],this.updateParentState(e),this.updateIndeterminateStates()},updateParentState(e){let t=this.findParentKey(e);if(!t)return;let i=this.getChildrenKeys(t),s=i.every(l=>this.isChecked(l)),n=i.some(l=>this.isChecked(l)),r=this.isChecked(t);s&&!r?this.storeParentKeys&&(this.state=[...this.state,t]):!n&&r&&(this.state=this.state.filter(l=>l!==t)),this.updateParentState(t)},updateIndeterminateStates(){this.indeterminateItems=this.calculateIndeterminateItems(this.options)},calculateIndeterminateItems(e){let t=[];return Object.entries(e).forEach(([i,s])=>{if(s.children){let n=this.getChildrenKeysFromOption(s.children),r=n.filter(C=>this.isChecked(C));r.length>0&&r.length<n.length&&t.push(i);let l=this.calculateIndeterminateItems(s.children);t.push(...l)}}),t},getChildrenKeys(e){return this.findChildrenKeysInOptions(this.options,e)},findChildrenKeysInOptions(e,t){for(let[i,s]of Object.entries(e)){if(i===t&&s.children)return this.getChildrenKeysFromOption(s.children);if(s.children){let n=this.findChildrenKeysInOptions(s.children,t);if(n.length>0)return n}}return[]},getChildrenKeysFromOption(e){let t=[];return Object.entries(e).forEach(([i,s])=>{t.push(i),s.children&&t.push(...this.getChildrenKeysFromOption(s.children))}),t},findParentKey(e,t=null,i=null){t=t||this.options;for(let[s,n]of Object.entries(t))if(n.children){if(Object.keys(n.children).includes(e))return s;let r=this.findParentKey(e,n.children,s);if(r)return r}return null}}}window.checkboxTreeFormComponent=h;export{h as default};
