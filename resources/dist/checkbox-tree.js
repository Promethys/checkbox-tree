function h({state:a,options:c,indeterminateItems:d,searchable:o=!1,collapsible:u=!1,defaultCollapsed:f=!1,parentKeys:p=[],storeParentKeys:y=!1}){return{state:a,options:c,indeterminateItems:d,areAllSelected:!1,searchable:o,search:"",collapsible:u,defaultCollapsed:f,collapsedItems:[],parentKeys:p,storeParentKeys:y,init(){this.$watch("state",()=>{this.updateIndeterminateStates(),this.updateAreAllSelected()}),this.updateAreAllSelected(),this.collapsible&&(this.collapsedItems=this.defaultCollapsed?[...this.parentKeys]:[]),this.$nextTick(()=>{this.updateIndeterminateStates()})},filterState(t){return this.storeParentKeys?t:t.filter(e=>!this.parentKeys.includes(e))},isCollapsed(t){return this.collapsible?this.collapsedItems.includes(t):!1},toggleCollapsed(t){this.collapsible&&(this.collapsedItems.includes(t)?this.collapsedItems=this.collapsedItems.filter(e=>e!==t):this.collapsedItems=[...this.collapsedItems,t])},expandAll(){this.collapsedItems=[]},collapseAll(){this.collapsedItems=[...this.parentKeys]},isItemVisible(t,e){if(!this.searchable||!this.search||this.search.trim()==="")return!0;let i=this.search.toLowerCase();if((e||"").toLowerCase().includes(i))return!0;let n=this.findOptionByKey(t);return n&&n.children?this.hasMatchingDescendant(n.children,i):!1},hasMatchingDescendant(t,e){for(let[i,s]of Object.entries(t))if((typeof s=="string"?s:s.label||"").toLowerCase().includes(e)||s.children&&this.hasMatchingDescendant(s.children,e))return!0;return!1},findOptionByKey(t,e=null){e=e||this.options;for(let[i,s]of Object.entries(e)){if(i===t)return s;if(s.children){let n=this.findOptionByKey(t,s.children);if(n)return n}}return null},hasVisibleResults(){if(!this.searchable||!this.search||this.search.trim()==="")return!0;let t=this.search.toLowerCase();return this.hasAnyMatch(this.options,t)},hasAnyMatch(t,e){for(let[i,s]of Object.entries(t))if((typeof s=="string"?s:s.label||"").toLowerCase().includes(e)||s.children&&this.hasAnyMatch(s.children,e))return!0;return!1},selectAll(){this.state=this.filterState(this.getAllKeys(this.options)),this.updateIndeterminateStates(),this.updateAreAllSelected()},deselectAll(){this.state=[],this.updateIndeterminateStates(),this.updateAreAllSelected()},updateAreAllSelected(){let t=this.getAllKeys(this.options),e=this.filterState(t);this.areAllSelected=e.length>0&&e.every(i=>this.isChecked(i))},getAllKeys(t){let e=[];return Object.entries(t).forEach(([i,s])=>{e.push(i),s.children&&Object.keys(s.children).length>0&&e.push(...this.getAllKeys(s.children))}),e},isChecked(t){return Array.isArray(this.state)&&this.state.includes(t)},isParentChecked(t){let e=this.getChildrenKeys(t);return e.length===0?this.isChecked(t):e.every(i=>this.isChecked(i))},isIndeterminate(t){let e=this.getChildrenKeys(t);if(e.length===0)return!1;let i=e.filter(s=>this.isChecked(s));return i.length>0&&i.length<e.length},toggleParent(t){let e=this.getChildrenKeys(t),i=!this.isParentChecked(t);if(Array.isArray(this.state)||(this.state=[]),i){let s=this.filterState([t,...e]).filter(n=>!this.state.includes(n));this.state=[...this.state,...s]}else{let s=[t,...e];this.state=this.state.filter(n=>!s.includes(n))}this.updateIndeterminateStates()},toggleChild(t){Array.isArray(this.state)||(this.state=[]),this.isChecked(t)?this.state=this.state.filter(i=>i!==t):this.state=[...this.state,t],this.updateParentState(t),this.updateIndeterminateStates()},updateParentState(t){let e=this.findParentKey(t);if(!e)return;let i=this.getChildrenKeys(e),s=i.every(l=>this.isChecked(l)),n=i.some(l=>this.isChecked(l)),r=this.isChecked(e);s&&!r?this.storeParentKeys&&(this.state=[...this.state,e]):!n&&r&&(this.state=this.state.filter(l=>l!==e)),this.updateParentState(e)},updateIndeterminateStates(){this.indeterminateItems=this.calculateIndeterminateItems(this.options),this.$nextTick(()=>{this.$el.querySelectorAll('.fi-fo-checkbox-tree-item input[type="checkbox"][x-bind\\:indeterminate]').forEach(e=>{let i=e.getAttribute("value");this.indeterminateItems.includes(i)?e.indeterminate=!0:e.indeterminate=!1})})},calculateIndeterminateItems(t){let e=[];return Object.entries(t).forEach(([i,s])=>{if(s.children){let n=this.getChildrenKeysFromOption(s.children),r=n.filter(m=>this.isChecked(m));r.length>0&&r.length<n.length&&e.push(i);let l=this.calculateIndeterminateItems(s.children);e.push(...l)}}),e},getChildrenKeys(t){return this.findChildrenKeysInOptions(this.options,t)},findChildrenKeysInOptions(t,e){for(let[i,s]of Object.entries(t)){if(i===e&&s.children)return this.getChildrenKeysFromOption(s.children);if(s.children){let n=this.findChildrenKeysInOptions(s.children,e);if(n.length>0)return n}}return[]},getChildrenKeysFromOption(t){let e=[];return Object.entries(t).forEach(([i,s])=>{e.push(i),s.children&&e.push(...this.getChildrenKeysFromOption(s.children))}),e},findParentKey(t,e=null,i=null){e=e||this.options;for(let[s,n]of Object.entries(e))if(n.children){if(Object.keys(n.children).includes(t))return s;let r=this.findParentKey(t,n.children,s);if(r)return r}return null}}}window.checkboxTreeFormComponent=h;export{h as default};
